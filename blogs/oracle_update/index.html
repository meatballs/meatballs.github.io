<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=icon href=/favicon-32x32.png type=image/gif><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" media=print onload='this.media="all"'><noscript><link href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet></noscript><link rel=stylesheet href=/css/font.css media=all><meta property="og:title" content="Oracle Update Statements"><meta property="og:description" content="There are several methods in Oracle SQL to update records in one table based on the content of another table.
Here, I give some of those methods and some guidance on where they might be most appropriate.
The Basics Oracle uses a &lsquo;correlated subquery&rsquo; syntax which looks like this:
UPDATE target t SET t.column = s.column (SELECT FROM source s WHERE s.join_column = t.join_column) The bracketed subquery joins the source and target tables and the target table is updated with values from the source column."><meta property="og:type" content="article"><meta property="og:url" content="https://owencampbell.me.uk/blogs/oracle_update/"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2012-03-08T00:00:00+00:00"><meta property="article:modified_time" content="2012-03-08T00:00:00+00:00"><meta property="og:site_name" content="Owen Campbell"><meta name=twitter:card content="summary"><meta name=twitter:title content="Oracle Update Statements"><meta name=twitter:description content="There are several methods in Oracle SQL to update records in one table based on the content of another table.
Here, I give some of those methods and some guidance on where they might be most appropriate.
The Basics Oracle uses a &lsquo;correlated subquery&rsquo; syntax which looks like this:
UPDATE target t SET t.column = s.column (SELECT FROM source s WHERE s.join_column = t.join_column) The bracketed subquery joins the source and target tables and the target table is updated with values from the source column."><link rel=stylesheet href=/bootstrap-5/css/bootstrap.min.css media=all><link rel=stylesheet href=/css/header.css media=all><link rel=stylesheet href=/css/footer.css media=all><link rel=stylesheet href=/css/theme.css media=all><style>:root{--text-color:#343a40;--text-secondary-color:#6c757d;--background-color:#eaedf0;--secondary-background-color:#64ffda1a;--primary-color:#007bff;--secondary-color:#f8f9fa;--text-color-dark:#e4e6eb;--text-secondary-color-dark:#b0b3b8;--background-color-dark:#18191a;--secondary-background-color-dark:#212529;--primary-color-dark:#ffffff;--secondary-color-dark:#212529}body{font-size:1rem;font-weight:400;line-height:1.5;text-align:left}</style><meta name=description content><link rel=stylesheet href=/css/single.css><script defer src=/fontawesome-5/all-5.15.4.js></script><title>Oracle Update Statements | Owen Campbell</title></head><body class=light onload=loading()><header><nav class="pt-3 navbar navbar-expand-lg"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/><img src=/favicon-32x32.png width=30 height=30 class="d-inline-block align-top">
Owen Campbell</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation"><svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text"><a class=nav-link href=/#about aria-label=about>About</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#contact aria-label=contact>Contact</a></li><li class="nav-item navbar-text"><a class=nav-link href=/blogs title="Blog posts">Blog</a></li></ul></div></div></nav></header><div id=content><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><div class="title mb-5"><h1 class="text-center mb-4">Oracle Update Statements</h1><div class=text-center><small>|</small>
Mar 8, 2012</div></div><article class="page-content p-2"><p>There are several methods in Oracle SQL to update records in one table based on the content of another table.</p><p>Here, I give some of those methods and some guidance on where they might be most appropriate.</p><h2 id=the-basics>The Basics</h2><p>Oracle uses a &lsquo;correlated subquery&rsquo; syntax which looks like this:</p><pre tabindex=0><code>UPDATE  target t
SET t.column = s.column
(SELECT
FROM  source s
WHERE s.join_column = t.join_column)
</code></pre><p>The bracketed subquery joins the source and target tables and the target table is updated with values from the source column. I&rsquo;ve shown a simple join between the two tables using one column from each, but the WHERE clause in the subquery can be as complex as required.</p><h2 id=nulls>NULLs</h2><p>The basic syntax I&rsquo;ve given above assumes that there is one, and only one, matching record in the source table for each target record.</p><p>If there are records in the target table with no matching source record, Oracle will return a &lsquo;Cannot update to null&rsquo; error. In other words, if it can&rsquo;t find a matching record in the source table (according to whatever join criteria have been used), then how can it know the value to update the target record?</p><p>There are several ways to deal with this problem:</p><h2 id=a-where-clause>A WHERE Clause</h2><p>The simplest method is to limit the set of target records which are to be updated:</p><pre tabindex=0><code>UPDATE  target t
SET t.column = s.column
(SELECT
FROM  source s
WHERE s.join_column = t.join_column)
WHERE t.column......
</code></pre><p>Above, I&rsquo;ve added a simple WHERE clause to the main query (not to be confused with the WHERE clause in the subquery which joins the two tables). This simply applies a criterion to some column on the target table and limits the update to those records which meet the criterion.</p><h2 id=the-nvl-function>The NVL function</h2><p>It&rsquo;s not always possible to determine in advance the set of records to be updated. Often, we want to update those target records which have a matching source record and that can be a dynamic set. One simple method uses the NVL function which allows us to make a substitution when a NULL value is encountered. Here&rsquo;s some example code:</p><pre tabindex=0><code>UPDATE  target t
SET t.column = s.column
NVL((SELECT
FROM  source s
WHERE s.join_column = t.join_column),)
</code></pre><p>This code wraps the subquery inside the NVL function so that any target records without matching source records will be updated to their current content. In other words, all matching records will be updated to the value from the source table, all other records will remain the same.</p><p>It&rsquo;s worth noting that in this example, every record in the target table still updated. It&rsquo;s just that some of them will be updated to the same value that they already contained. This can be inefficient if only a small percentage of the target records are matched.</p><h2 id=where-exists>WHERE EXISTS</h2><p>It&rsquo;s possible to limit the target records to precisely those matched in the source table by using the WHERE EXISTS syntax:</p><pre tabindex=0><code>UPDATE  target t
SET t.column = s.column
(SELECT
FROM  source s
WHERE s.join_column = t.join_column)
WHERE EXISTS
(SELECT *
FROM  s
WHERE s.join_column = t.join_column)
</code></pre><p>This is a more complex WHERE clause than the earlier simple example, but it&rsquo;s the same idea; we&rsquo;re using a WHERE clause to limit the set of target records to be affected by the UPDATE.</p><p>I&rsquo;ve shown the join in the WHERE EXISTS clause to be identical to that in the original subquery. This means that the target set is limited precisely to those matching records. However, there is no reason why the EXISTS join should not return a different set, if required. If it returns a subset, it merely limits the target set further. If it returns more records than the matched set, then those null values would have to be dealt with using further WHERE clauses or the NVL function (or both!!).</p><p>Whether the NVL function or the WHERE EXISTS method is more efficient depends entirely upon the nature and circumstances of your application (e.g. the absolute and relative size of the tables, the complexity of the joins, the uniqueness of the records, the existence of indexes). It is well worthwhile to try both and to look at the execution plan before settling on a preferred solution.</p><h2 id=inline-views>Inline Views</h2><p>This is possibly my favourite method!! Although I normally try more than one solution and use the execution plan to determine my preference, it&rsquo;s rare that any other method beats the inline view for efficiency.</p><p>The idea here is that we update a view rather than a table. Any joins or limitations on the set to update are performed in the view:</p><pre tabindex=0><code>UPDATE
(SELECT t.column, s.column
FROM  target t,  source s
WHERE s.join_column = t.join_column)
SET t.column = s.column
</code></pre><p>There are some restrictions on whether Oracle will allow tables to be updated via a view. Essentially, each row in the view must map to one and only one record in the underlying target table or, to put it in the more common jargon, the primary key of the target table must be preserved in the view.</p></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div class=sticky-sidebar><aside class=toc><h5>Table Of Contents</h5><div class=toc-content><nav id=TableOfContents><ul><li><a href=#the-basics>The Basics</a></li><li><a href=#nulls>NULLs</a></li><li><a href=#a-where-clause>A WHERE Clause</a></li><li><a href=#the-nvl-function>The NVL function</a></li><li><a href=#where-exists>WHERE EXISTS</a></li><li><a href=#inline-views>Inline Views</a></li></ul></nav></div></aside><aside class=tags><h5>Tags</h5><ul class="tags-ul list-unstyled list-inline"><li class=list-inline-item><a href=https://owencampbell.me.uk/tags/oracle target=_blank>Oracle</a></li><li class=list-inline-item><a href=https://owencampbell.me.uk/tags/sql target=_blank>SQL</a></li></ul></aside><aside class=social><h5>Social</h5><div class=social-content><ul class=list-inline><li class="list-inline-item text-center"><a target=_blank href="https://twitter.com/share?text=Oracle%20Update%20Statements&url=https%3a%2f%2fowencampbell.me.uk%2fblogs%2foracle_update%2f"><i class="fab fa-twitter"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="https://api.whatsapp.com/send?text=Oracle%20Update%20Statements: https%3a%2f%2fowencampbell.me.uk%2fblogs%2foracle_update%2f"><i class="fab fa-whatsapp"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="mailto:?subject=Oracle%20Update%20Statements&body=Check out this site https%3a%2f%2fowencampbell.me.uk%2fblogs%2foracle_update%2f"><i class="fa fa-envelope"></i></a></li></ul></div></aside></div></div></div><div class=row><div class="col-sm-12 col-md-12 col-lg-9 p-4"></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<i class="fas fa-angle-up"></i></button></section><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?topScroll.style.display="block":topScroll.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script></div><footer><div class="container py-3" id=recent-posts><div class="h3 text-center text-secondary py-3">Recent posts</div><div class="row justify-content-center"><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/pyconuk_everyone_pays/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="Everyone Pays to Attend PyCon UK">Everyone Pays to Attend …</h5></a><div class="card-text secondary-font"><p>PyCon UK has a long-standing policy that everyone pays to attend - speakers, organisers, everyone. That often causes some consterntation with reactions like "I have to pay to speak at PyCon UK?!!" or "If I volunteer to help, I have to pay the same as someone who has done …</p></div></div><div class="mt-auto card-footer"><span class=float-start>September 7, 2022</span>
<a href=/blogs/pyconuk_everyone_pays/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/lightning_talks/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="Lightning Talks and Buckets">Lightning Talks and …</h5></a><div class="card-text secondary-font"><p>PyCon UK 2016 At PyCon UK 2016, I became annoyed.
I was fully part of the organising team for the first time and we had spent part of our opening morning's session introducing lightning talks: explaining how they were an ideal way for new speakers to begin their speaking career.
At the time, the …</p></div></div><div class="mt-auto card-footer"><span class=float-start>October 2, 2018</span>
<a href=/blogs/lightning_talks/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/conference_guidelines/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="My Conference Attendance Guidelines">My Conference Attendance …</h5></a><div class="card-text secondary-font"><p>I regularly attend technical conferences in order to learn, make new contacts and generally participate in whatever community that conference represents.
Over the years, I have found that the best way to increase my chances of making new friends and contacts is to speak at the conference - people …</p></div></div><div class="mt-auto card-footer"><span class=float-start>April 11, 2018</span>
<a href=/blogs/conference_guidelines/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div></div></div><div class="text-center pt-2"><span class=px-1><a href=https://github.com/meatballs aria-label=github><svg xmlns="http://www.w3.org/2000/svg" width="2.7em" height="2.7em" viewBox="0 0 1792 1792"><path d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5T1376 1664h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105T1386 856q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27T578 459.5 492 446q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5T484 1274q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5H416q-119 0-203.5-84.5T128 1376V416q0-119 84.5-203.5T416 128h960q119 0 203.5 84.5T1664 416z"/></svg></a></span><span class=px-1><a href=https://linkedin.com/in/owencampbell aria-label=linkedin><svg xmlns="http://www.w3.org/2000/svg" width="2.4em" height="2.4em" fill="#fff" aria-label="LinkedIn" viewBox="0 0 512 512"><rect width="512" height="512" fill="#0077b5" rx="15%"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg></a></span></div><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center"><div class=pb-2><a href=https://owencampbell.me.uk title="Owen Campbell"><img alt="Footer logo" src=/favicon-32x32.png height=40px width=40px></a></div>&copy; 2022 All Rights Reserved<div class=text-secondary>Made with
<span class=text-danger>&#10084;</span>
and
<a href=https://github.com/gurusabarish/hugo-profile target=_blank title="Designed and developed by gurusabarish">Hugo Profile</a></div></div></div></div></footer><script src=/bootstrap-5/js/bootstrap.bundle.min.js></script>
<script>document.body.className.includes("light")&&(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))</script><script>let loadingIcons;function loading(){myVar=setTimeout(showPage,100)}function showPage(){try{document.getElementById("loading-icons").style.display="block"}catch{}}</script></body></html>